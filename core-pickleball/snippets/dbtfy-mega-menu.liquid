{%- comment -%}Please do not edit this file. Any modification can be lost as it is automatically updated by Debutify{%- endcomment -%}
{%- if section.blocks.size > 0 -%}
<div class="dbtfy dbtfy-mega_menu">
  <div id="MegaMenu" class="small--hide medium--hide">

    <!-- Blocks -->
    {% for block in section.blocks %}
    <div class="item-mega_menu item-mega_menu-{{ block.id }}" {{ block.shopify_attributes }} data-trigger="{{ block.settings.dbtfy_mega_menu_trigger }}">

      <div class="wrapper">
        {% if block.type == "mega" %}
          {% assign has_product_1 = false %}
          {% assign has_product_2 = false %}
          {% assign has_product_3 = false %}
          <div class="grid grid-uniform multi-mega_menu">
            {% assign column_number = 0 %}

            {% if block.settings.dbtfy_mega_menu_multi != empty %}
              {% for link in linklists[block.settings.dbtfy_mega_menu_multi].links %}
                {% assign column_number = column_number | plus: 1 %}
              {% endfor %}
            {% endif %}

            {% if block.settings.dbtfy_mega_menu_multi_product_1 != empty %}
              {% assign column_number = column_number | plus: 1 %}
              {% assign product_1 = all_products[block.settings.dbtfy_mega_menu_multi_product_1] %}
              {% assign has_product_1 = true %}
            {% endif %}

            {% if block.settings.dbtfy_mega_menu_multi_product_2 != empty %}
              {% assign column_number = column_number | plus: 1 %}
              {% assign product_2 = all_products[block.settings.dbtfy_mega_menu_multi_product_2] %}
              {% assign has_product_2 = true %}
            {% endif %}

            {% if block.settings.dbtfy_mega_menu_multi_product_3 != empty %}
              {% assign column_number = column_number | plus: 1 %}
              {% assign product_3 = all_products[block.settings.dbtfy_mega_menu_multi_product_3] %}
              {% assign has_product_3 = true %}
            {% endif %}

            {% if block.settings.dbtfy_mega_menu_multi_image != blank %}
              {% assign column_number = column_number | plus: 1 %}
            {% endif %}

            {% if column_number == 1 %}
              {% if block.settings.dbtfy_mega_menu_multi_product_1 != empty or block.settings.dbtfy_mega_menu_multi_product_2 != empty or block.settings.dbtfy_mega_menu_multi_product_3 != empty %}
                {% assign grid_item_width = "large--one-fifth" %}
              {% else %}
                {% assign grid_item_width = "one-whole" %}
              {% endif %}
            {% else %}
              {% assign grid_item_width = "large--one-fifth" %}
            {% endif %}

            {% if block.settings.dbtfy_mega_menu_multi != empty %}
              {% for link in linklists[block.settings.dbtfy_mega_menu_multi].links %}
              <div class="grid__item {{ grid_item_width }}">
                {% if block.settings.dbtfy_mega_menu_header and column_number > 1 %}
                  <a href="{{ link.url }}" class="h4 title-product-mega_menu">
                    {{ link.title }}
                  </a>
                {% endif %}

                {% if link.links != blank %}
                <ul class="no-bullets{% if column_number == 1 %} inline-list{% endif %}">
                  {% for childlink in link.links %}
                    <li><a href="{{ childlink.url }}">{{ childlink.title }}</a></li>
                  {% endfor %}
                </ul>
                {% endif %}

              </div>
              {% endfor %}
            {% endif %}

            {% if column_number < 5 and block.settings.dbtfy_mega_menu_multi_image == blank %}
              <div class="grid__item {{ grid_item_width }} item-fill"></div>
            {% endif %}

            {% if has_product_1 %}
              {% include "product-grid-item" with product_1 as product %}
            {% endif %}

            {% if has_product_2 %}
              {% include "product-grid-item" with product_2 as product %}
            {% endif %}

            {% if has_product_3 %}
              {% include "product-grid-item" with product_3 as product %}
            {% endif %}

            {% if block.settings.dbtfy_mega_menu_multi_image != blank %}
            <div class="grid__item {{ grid_item_width }} item-fill">
              {% if block.settings.dbtfy_mega_menu_multi_image_link != blank %}
              <a class="image-link" href="{{ block.settings.dbtfy_mega_menu_multi_image_link }}">
              {% endif %}

                <div class="image-wrapper" style="padding-top:{{ 1 | divided_by: block.settings.dbtfy_mega_menu_multi_image.aspect_ratio | times: 100}}%;">
                  {% assign img_url = block.settings.dbtfy_mega_menu_multi_image | img_url: "1x1" | replace: "_1x1.", "_{width}x." %}
                  <img class="image lazyload"
                    src="{{ block.settings.dbtfy_mega_menu_multi_image | img_url: '300x300' }}"
                    data-src="{{ img_url }}"
                    data-widths="[180, 360, 540, 720, 900, 1080, 1296, 1512, 1728, 2048]"
                    data-aspectratio="{{ block.settings.dbtfy_mega_menu_multi_image.aspect_ratio }}"
                    data-sizes="auto"
                    alt="{{ block.settings.dbtfy_mega_menu_multi_image.alt | escape }}">
                </div>

              {% if block.settings.dbtfy_mega_menu_multi_image_link != blank %}
              </a>
              {% endif %}
            </div>
            {% endif %}
          </div>
        {% endif %}

        {% if block.type == "product" %}
          {% if block.settings.dbtfy_mega_menu_header %}
          <div class="header-wrapper-mega_menu">
            <h4 class="title-product-mega_menu">
              <a href="{{ collections[block.settings.dbtfy_mega_menu_product].url }}">{{ collections[block.settings.dbtfy_mega_menu_product].title | escape }}</a>
            </h4>
            <a class="link-mega_menu text-link" href="{{ collections[block.settings.dbtfy_mega_menu_product].url }}">{{ "blogs.article.view_all" | t }}</a>
          </div>
          {% endif %}
          {% assign counter = 0 %}
          {% if block.settings.dbtfy_mega_menu_product_grid == "4" %}
            {% assign limit = 4 %}
            {% assign grid_item_width = "large--three-twelfths" %}
          {% elsif block.settings.dbtfy_mega_menu_product_grid == "5" %}
        	{% assign limit = 5 %}
          	{% assign grid_item_width = "large--one-fifth" %}
          {% endif %}
          <div class="grid grid-uniform">
            {% for product in collections[block.settings.dbtfy_mega_menu_product].products %}
              {% include "product-grid-item" %}
            {% endfor %}
          </div>
        {% endif %}

        {% if block.type == "collection" %}
          {% if block.settings.dbtfy_mega_menu_header %}
          <div class="header-wrapper-mega_menu">
            <h4 class="title-product-mega_menu">
              <a href="/collections">{{ block.settings.dbtfy_mega_menu_title }}</a>
            </h4>
            <a class="link-mega_menu text-link" href="/collections">{{ "blogs.article.view_all" | t }}</a>
          </div>
          {% endif %}
          <div class="grid grid-uniform grid--spacer collection-mega_menu">
            {% assign collection_index = 0 %}
            {% assign collection_count = 0 %}

            {% assign collection_1 = block.settings.dbtfy_mega_menu_collection_1 %}
            {% assign collection_2 = block.settings.dbtfy_mega_menu_collection_2 %}
            {% assign collection_3 = block.settings.dbtfy_mega_menu_collection_3 %}
            {% assign collection_4 = block.settings.dbtfy_mega_menu_collection_4 %}
            {% assign collection_5 = block.settings.dbtfy_mega_menu_collection_5 %}
            {% assign collection_6 = block.settings.dbtfy_mega_menu_collection_6 %}

            {% if collection_1 != empty %}{% assign collection_count = collection_count | plus: 1 %}{% endif %}
            {% if collection_2 != empty %}{% assign collection_count = collection_count | plus: 1 %}{% endif %}
            {% if collection_3 != empty %}{% assign collection_count = collection_count | plus: 1 %}{% endif %}
            {% if collection_4 != empty %}{% assign collection_count = collection_count | plus: 1 %}{% endif %}
            {% if collection_5 != empty %}{% assign collection_count = collection_count | plus: 1 %}{% endif %}
            {% if collection_6 != empty %}{% assign collection_count = collection_count | plus: 1 %}{% endif %}

            {% assign collection_limit = collection_count %}
            {% assign divisible_by_three = collection_count | modulo: 3 %}
            {% assign divisible_by_two = collection_count | modulo: 2 %}

            {% if collection_1 != empty %}
              {% assign collection = collections[collection_1] %}
              {% assign collection_index = collection_index | plus: 1 %}
              {% assign collection_handle = collection.handle %}
              {% include "collection-grid-collage" %}
            {% endif %}

            {% if collection_2 != empty %}
              {% assign collection = collections[collection_2] %}
              {% assign collection_index = collection_index | plus: 1 %}
              {% assign collection_handle = collection.handle %}
              {% include "collection-grid-collage" %}
            {% endif %}

            {% if collection_3 != empty %}
              {% assign collection = collections[collection_3] %}
              {% assign collection_index = collection_index | plus: 1 %}
              {% assign collection_handle = collection.handle %}
              {% include "collection-grid-collage" %}
            {% endif %}

            {% if collection_4 != empty %}
              {% assign collection = collections[collection_4] %}
              {% assign collection_index = collection_index | plus: 1 %}
              {% assign collection_handle = collection.handle %}
              {% include "collection-grid-collage" %}
            {% endif %}

            {% if collection_5 != empty %}
              {% assign collection = collections[collection_5] %}
              {% assign collection_index = collection_index | plus: 1 %}
              {% assign collection_handle = collection.handle %}
              {% include "collection-grid-collage" %}
            {% endif %}

            {% if collection_6 != empty %}
              {% assign collection = collections[collection_6] %}
              {% assign collection_index = collection_index | plus: 1 %}
              {% assign collection_handle = collection.handle %}
              {% include "collection-grid-collage" %}
            {% endif %}
          </div>
        {% endif %}

        {% if block.type == "blog" %}
		  {% if block.settings.dbtfy_mega_menu_header %}
          <div class="header-wrapper-mega_menu">
            <h4 class="title-product-mega_menu">
              <a href="{{ blogs[block.settings.dbtfy_mega_menu_blog].url }}">{{ blogs[block.settings.dbtfy_mega_menu_blog].title | escape }}</a>
            </h4>
            <a class="link-mega_menu text-link" href="{{ blogs[block.settings.dbtfy_mega_menu_blog].url }}">{{ "blogs.article.view_all" | t }}</a>
          </div>
          {% endif %}
          {% assign counter = 0 %}
          {% assign limit = 3 %}
          {% assign grid_item_width = "large--four-twelfths" %}
          <div class="grid grid-uniform">
            {% for article in blogs[block.settings.dbtfy_mega_menu_blog].articles %}
              {% include "article-grid-item" %}
              {% assign counter = counter | plus: 1 %}
              {% if counter == limit %}
                {% break %}
              {% endif %}
            {% endfor %}
          </div>
        {% endif %}

        {% if block.type == "html" %}
          {{ block.settings.dbtfy_mega_menu_html }}
        {% endif %}

      </div>
    </div>
    {% endfor %}
  </div>
</div>
{%- endif -%}