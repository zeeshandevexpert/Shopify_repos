{%- comment -%}Please do not edit this file. Any modification can be lost as it is automatically updated by Debutify{%- endcomment -%}
{%- if settings.dbtfy_collection_addtocart -%}
{%- if type == "image" -%}
  {%- assign loop = 0 -%}
  {% unless product.has_only_default_variant %}
    {% if product.variants.size > 1 %}
      {% for variant in product.variants %}
        {%- assign loop = loop | plus: 1 -%}
        {% if variant.image and variant.available %}
          {%- assign image = variant.image -%}
          {%- assign img_url = image | img_url: "1x1" | replace: "_1x1.", "_{width}x." -%}

          <div id="ProductImageWrapper-{{ variant.id }}" class="product--wrapper image-wrapper image-collection_addtocart" style="{% unless loop == 1 %}display:none;{% endunless %}">
            <div style="padding-top:{{ 1 | divided_by: image.aspect_ratio | times: 100 }}%;">
              <img class="product--image image lazyload {{ img_id_class }}"
                   src="{{ image | img_url: "small" }}"
                   data-src="{{ img_url }}"
                   data-widths="[180, 370, 590, 740, 900, 1080, 1296, 1512, 1728, 2048]"
                   data-aspectratio="{{ image.aspect_ratio }}"
                   data-sizes="auto"
                   alt="{{ image.alt | escape }}"
                   data-image>
            </div>
          </div>

		{% else %}
		  {% if variant.image %}
          {%- assign loop = loop | minus: 1 -%}
		  {% endif %}
        {% endif %}
      {% endfor %}
	{% endif %}
  {% endunless %}
  {%- assign img_url = product.featured_image | img_url: "1x1" | replace: "_1x1.", "_{width}x." -%}
{%- else -%}
<div class="dbtfy dbtfy-collection_addtocart">
  <div id="CollectionAddtocart" class="{% if settings.dbtfy_collection_addtocart_full %}full-collection_addtocart {% endif %}{% if product.variants.size > 1 %}variant-collection_addtocart {% else %}no-variant-collection_addtocart {% endif %}">

    {% unless emptyState %}
    <form autocomplete="off" action="/cart/add" method="post" class="add-to-cart__form form-collection_addtocart {% if sold_out %}variant-soldout{% else %}variant-available{% endif %}" enctype="multipart/form-data">
      <select class="select--small full select-collection_addtocart" name="id">
        {% if product.variants.size > 1 %}
          {% for variant in product.variants %}
            {% if variant.available %}
            <option {% if variant == product.selected_or_first_available_variant %}selected="selected"{% endif %} value="{{ variant.id }}">{{ variant.title | escape }} - {{ variant.price | money }}</option>
            {% else %}
            <option disabled="disabled">{{ variant.title | escape }} - {{ "products.product.sold_out" | t }}</option>
            {% endif %}
        {% endfor %}
        {% else %}
          {% if variant.available %}
          <option {% if variant == product.selected_or_first_available_variant %}selected="selected"{% endif %} value="{{ variant.id }}">{{ product.title | escape }} - {{ variant.price | money }}</option>
          {% else %}
          <option {% if variant == product.selected_or_first_available_variant %}selected="selected"{% endif %} disabled="disabled">{{ product.title | escape }} - {{ "products.product.sold_out" | t }}</option>
          {% endif %}
        {% endif %}
      </select>
      <button type="submit" name="add"
              class="btn {{ settings.dbtfy_collection_addtocart_button_style }} btn-collection_addtocart btn--add-to-cart add-to-cart {% if product.variants.size > 1 or settings.dbtfy_collection_addtocart_full == false %} btn-square-small{% else %} btn--small {% endif %}"
              {% if sold_out %} disabled="disabled"{% endif %}>
        <span class="btn__text">
          {% if sold_out %}
          <span class="fas fa-clock button-soldout-icon"></span>
          {% else %}
          <span class="fas fa-shopping-{{ settings.cart_icon }} button-cart-icon"></span>
          {% endif %}
          <span class="btn__add-to-cart-text">
            {% if sold_out %}
            {{ "products.product.sold_out" | t }}
            {% else %}
            {{ "products.product.add_to_cart" | t }}
            {% endif %}
          </span>
        </span>
      </button>
    </form>
    {% endunless %}

  </div>
</div>
{%- endif -%}
{%- endif -%}