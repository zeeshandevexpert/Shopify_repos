customElements.get("quick-add")||customElements.define("quick-add",class extends HTMLElement{constructor(){super();this.querySelectorAll("button").forEach(a=>a.addEventListener("click",this.onButtonClick.bind(this)));this.querySelector(".quick-add__add-button").addEventListener("click",this.onButtonClick.bind(this));this.card=this.closest(".card");this.cardLink=this.card.querySelector(".card__heading.h4 a");this.productUrl=this.cardLink.getAttribute("data-product-url");this.json=JSON.parse(this.card.getAttribute("data-json"));
this.variants=this.json.variants;this.colorButtons=this.card.querySelectorAll(".quick-add__button--color");this.colorButtons.forEach(a=>a.addEventListener("click",this.onColorButtonClick.bind(this)));this.colorIndex=this.json.options.indexOf("Color");this.sizeIndex=this.json.options.indexOf("Size");this.selectedColor=this.card.querySelector(".quick-add__button--color[selected]");this.addButton=this.querySelector(".quick-add__add-button");this.init()}onButtonClick(a){if(!this.addButton.classList.contains("BIS_trigger")){var b=
a.target.getAttribute("data-variant-id");a=a.target.getAttribute("data-properties")?JSON.parse(a.target.getAttribute("data-properties")):{};addToCart(b,1,a)}}updateUrl(){let a=!1;this.json.variants.forEach(b=>{b.options[this.colorIndex]!==this.selectedColor.value||a||(this.cardLink.setAttribute("href",`${this.productUrl}?variant=${b.id}`),a=!0)})}onColorButtonClick(){this.card.querySelectorAll(".quick-add__button--color").forEach(a=>a.removeAttribute("selected"));event.target.setAttribute("selected",
!0);this.selectedColor=event.target;this.changeImage();this.updateUrl();this.sizeAvailabilities();this.updateSelectedSize()}init(){this.selectedColor&&this.sizeAvailabilities()}updateSelectedSize(){if(this.selectedColor){var a=this.card.querySelector(".card__selected-color");a&&(a.innerHTML=this.selectedColor.value)}}sizeAvailabilities(){this.selectedColor&&this.variants.forEach(a=>{if(a.options[this.colorIndex]!==this.selectedColor.value)return!0;let b=this.querySelector(`button[value="${a.options[this.sizeIndex]}"]`);
b&&(b.disabled=!a.available)})}changeImage(){let a=!1;const b=this.card.querySelector(".card__media img");this.variants.forEach(c=>{if(c.options[this.colorIndex]!==this.selectedColor.value)return!0;a||(updateSrcSet(b,c.featured_image.src),a=!0)})}});
