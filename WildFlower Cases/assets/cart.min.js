class CartRemoveButton extends HTMLElement{constructor(){super();this.addEventListener("click",a=>{a.preventDefault();(this.closest("cart-items")||this.closest("cart-drawer-items")).updateQuantity(this.dataset.index,0,!1,a.target)})}}customElements.define("cart-remove-button",CartRemoveButton);
class CartItems extends HTMLElement{constructor(){super();this.lineItemStatusElement=document.getElementById("shopping-cart-line-item-status")||document.getElementById("CartDrawer-LineItemStatus");this.currentItemCount=Array.from(this.querySelectorAll('[name="updates[]"]')).reduce((a,b)=>a+parseInt(b.value),0);this.debouncedOnChange=debounce(a=>{this.onChange(a)},300);this.addEventListener("change",this.debouncedOnChange.bind(this))}onChange(a){this.updateQuantity(a.target.dataset.index,a.target.value,
document.activeElement.getAttribute("name"),a.target)}getSectionsToRender(){return[{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"},{id:"cart-live-region-text",section:"cart-live-region-text",selector:".shopify-section"},{id:"main-cart-footer",section:document.getElementById("main-cart-footer").dataset.id,selector:".js-contents"},{id:"main-cart-items",section:document.getElementById("main-cart-items").dataset.id,selector:".js-contents"},{id:"CartDrawer",section:"cart-drawer",
selector:".drawer__inner"}]}forceUpdateCartDrawer(){fetch(`${routes.cart_url}?sections=${this.getSectionsToRender().map(a=>a.section)}`).then(a=>a.text()).then(a=>{const b=JSON.parse(a);this.getSectionsToRender().forEach(d=>{const e=document.getElementById(d.id).querySelector(d.selector)||document.getElementById(d.id);if(!e)return!0;e.innerHTML=this.getSectionInnerHTML(b[d.section],d.selector)})})}refKeyMatch(a){return JSON.parse(this.querySelector(".cart-items").getAttribute("data-json")).find(b=>
b.properties._ref_key===a)}updateQuantity(a,b,d,e){JSON.parse(this.querySelector(".cart-items").getAttribute("data-json"));this.enableLoading(a);var k={};e=e.closest(".cart-item").dataset.key;k[e]=b;b=JSON.stringify({updates:k,sections:this.getSectionsToRender().map(c=>c.section),sections_url:window.location.pathname});fetch(`${routes.cart_update_url}`,{...fetchConfig(),body:b}).then(c=>c.text()).then(c=>{const f=JSON.parse(c);if(f.sections){this.classList.toggle("is-empty",0===f.item_count);c=document.querySelector("cart-drawer");
document.getElementById("main-cart-footer");this.getSectionsToRender().forEach(h=>{const l=document.getElementById(h.id).querySelector(h.selector)||document.getElementById(h.id);if(!l)return!0;l.innerHTML=this.getSectionInnerHTML(f.sections[h.section],h.selector)});var g=document.getElementById(`CartItem-${a}`)||document.getElementById(`CartDrawer-Item-${a}`);g&&g.querySelector(`[name="${d}"]`)?c?trapFocus(c,g.querySelector(`[name="${d}"]`)):g.querySelector(`[name="${d}"]`).focus():0===f.item_count&&
c?trapFocus(c.querySelector(".drawer__inner-empty"),c.querySelector("a")):document.querySelector(".cart-item")&&c&&trapFocus(c,document.querySelector(".cart-item__name"));"cart-drawer-items"===this.localName&&(c=(new DOMParser).parseFromString(f.sections["cart-drawer"],"text/html").querySelector(".wear-with__desktop"),g=document.querySelector(".wear-with__desktop"),c&&g&&(g.innerHTML=c.innerHTML,document.querySelector("cart-drawer").wearWith()));this.updateUpsells();this.disableLoading()}else this.forceUpdateCartDrawer()}).catch(c=>
{console.log(c);this.querySelectorAll(".loading-overlay").forEach(f=>f.classList.add("hidden"));(document.getElementById("cart-errors")||document.getElementById("CartDrawer-CartErrors")).textContent=window.cartStrings.error;this.disableLoading()})}updateUpsells(){document.querySelector(".cart-page__upsells .swiper")&&(initSwiper(),lazyImages())}updateLiveRegions(a,b){if(this.currentItemCount===b){const e=document.getElementById(`Line-item-error-${a}`)||document.getElementById(`CartDrawer-LineItemError-${a}`);
a=document.getElementById(`Quantity-${a}`)||document.getElementById(`Drawer-quantity-${a}`);e.querySelector(".cart-item__error-text").innerHTML=window.cartStrings.quantityError.replace("[quantity]",a.value)}this.currentItemCount=b;this.lineItemStatusElement.setAttribute("aria-hidden",!0);const d=document.getElementById("cart-live-region-text")||document.getElementById("CartDrawer-LiveRegionText");d.setAttribute("aria-hidden",!1);setTimeout(()=>{d.setAttribute("aria-hidden",!0)},1E3)}getSectionInnerHTML(a,
b){return(new DOMParser).parseFromString(a,"text/html").querySelector(b).innerHTML}enableLoading(a){(document.getElementById("main-cart-items")||document.getElementById("CartDrawer-CartItems")).classList.add("cart__items--disabled");const b=this.querySelectorAll(`#CartItem-${a} .loading-overlay`);a=this.querySelectorAll(`#CartDrawer-Item-${a} .loading-overlay`);[...b,...a].forEach(d=>d.classList.remove("hidden"));document.activeElement.blur();this.lineItemStatusElement.setAttribute("aria-hidden",
!1)}disableLoading(){(document.getElementById("main-cart-items")||document.getElementById("CartDrawer-CartItems")).classList.remove("cart__items--disabled")}}customElements.define("cart-items",CartItems);customElements.get("cart-note")||customElements.define("cart-note",class extends HTMLElement{constructor(){super();this.addEventListener("change",debounce(a=>{a=JSON.stringify({note:a.target.value});fetch(`${routes.cart_update_url}`,{...fetchConfig(),body:a})},300))}});
customElements.get("canvas-bag")||customElements.define("canvas-bag",class extends HTMLElement{constructor(){super();this.bagVariantId=39627214684273;this.cartItems=document.querySelector("cart-drawer-items");this.cartDrawer=document.querySelector("cart-drawer");this.addEventListener("change",debounce(a=>{a=parseFloat(this.querySelector(".quantity__input").value);a=JSON.stringify({updates:{39627214684273:a},sections:this.cartItems.getSectionsToRender().map(b=>b.section),sections_url:window.location.pathname});
fetch(`${routes.cart_update_url}`,{...fetchConfig(),body:a}).then(b=>b.json()).then(b=>{this.cartDrawer.renderContents(b)}).catch(b=>console.log(b))},300))}});
